# Pipedream Integration Notes (STRUKT AI Assistant)

## Current Flow:
1. Tiledesk chat widget captures user message
2. Webhook triggers Pipedream
3. Pipedream sends message to OpenAI (via `custom_request.js`)
4. Pipedream formats reply (via `return_response.js`)
5. BUT: Tiledesk expects an immediate response and executes too early

## Problem:
- Tiledesk returns `undefined` because it finishes the reply step before Pipedream responds.
- Pipedream's AI reply arrives ~15â€“20s too late.
- Adding delays in Tiledesk didn't work.

## Recommended Fix:
- Gemini & ChatGPT agree: Let Pipedream "push" the response **back to Tiledesk** instead of Tiledesk waiting for it.
- We need:
  - Tiledesk conversation ID or user ID
  - Correct Tiledesk messaging API endpoint
  - Pipedream step to send POST request with reply

## Next Steps:
- Add async push logic to Pipedream
- Fix reply handling in Tiledesk to display reply when it arrives
